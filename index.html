<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Friday Football Manager</title>
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
background: #121212;
color: #e0e0e0;
padding: 16px;
padding-bottom: 80px;
}

.container {
max-width: 600px;
margin: 0 auto;
}

h1 {
font-size: 32px;
font-weight: 300;
text-align: center;
margin: 24px 0;
color: #90CAF9;
letter-spacing: 1px;
}

.stats-grid {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 12px;
margin-bottom: 32px;
}

.stat-card {
background: #1e1e1e;
border-radius: 8px;
padding: 16px;
text-align: center;
border: 1px solid #2a2a2a;
}

.stat-value {
font-size: 28px;
font-weight: 600;
color: #64B5F6;
margin-bottom: 4px;
}

.stat-label {
font-size: 12px;
color: #9e9e9e;
text-transform: uppercase;
letter-spacing: 0.5px;
}

.section {
background: #1e1e1e;
border-radius: 8px;
padding: 20px;
margin-bottom: 16px;
border: 1px solid #2a2a2a;
}

.section-title {
font-size: 16px;
font-weight: 500;
margin-bottom: 16px;
color: #b0bec5;
text-align: center;
letter-spacing: 0.5px;
}

select, input {
width: 100%;
padding: 14px;
background: #2a2a2a;
border: 1px solid #3a3a3a;
border-radius: 6px;
color: #e0e0e0;
font-size: 15px;
margin-bottom: 12px;
font-family: inherit;
}

select:focus, input:focus {
outline: none;
border-color: #1976D2;
}

button {
width: 100%;
padding: 14px;
border: none;
border-radius: 6px;
font-size: 15px;
font-weight: 500;
cursor: pointer;
transition: all 0.2s;
font-family: inherit;
letter-spacing: 0.5px;
}

.btn-primary {
background: #1976D2;
color: white;
margin-bottom: 8px;
}

.btn-primary:hover {
background: #1565C0;
}

.btn-danger {
background: #D32F2F;
color: white;
}

.btn-danger:hover {
background: #C62828;
}

.btn-success {
background: #388E3C;
color: white;
}

.btn-success:hover {
background: #2E7D32;
}

.btn-warning {
background: #F57C00;
color: white;
}

.btn-warning:hover {
background: #EF6C00;
}

.player-list {
margin-top: 16px;
}

.player-item {
display: flex;
justify-content: space-between;
align-items: center;
padding: 12px;
background: #2a2a2a;
border-radius: 6px;
margin-bottom: 8px;
border: 1px solid #3a3a3a;
}

.player-name {
font-size: 15px;
color: #e0e0e0;
}

.player-games {
font-size: 13px;
color: #9e9e9e;
}

.empty-state {
text-align: center;
padding: 24px;
color: #757575;
font-size: 14px;
}

.admin-section {
margin-top: 32px;
padding-top: 24px;
border-top: 1px solid #2a2a2a;
}

.team-builder {
display: none;
margin-top: 16px;
}

.team-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
gap: 12px;
margin-bottom: 16px;
}

.team-box {
background: #2a2a2a;
border-radius: 6px;
padding: 12px;
border: 1px solid #3a3a3a;
}

.team-name {
font-size: 13px;
font-weight: 600;
color: #64B5F6;
margin-bottom: 8px;
text-align: center;
}

.team-player {
font-size: 13px;
padding: 6px;
background: #1e1e1e;
border-radius: 4px;
margin-bottom: 4px;
}

.stats-section {
margin-top: 32px;
}

.leaderboard {
margin-top: 12px;
}

.leaderboard-item {
display: grid;
grid-template-columns: 40px 1fr 60px;
align-items: center;
padding: 10px;
background: #2a2a2a;
border-radius: 6px;
margin-bottom: 6px;
border: 1px solid #3a3a3a;
}

.rank {
font-size: 18px;
font-weight: 700;
color: #FFD700;
text-align: center;
}

.rank-2 { color: #C0C0C0; }
.rank-3 { color: #CD7F32; }
.rank-other { color: #757575; font-size: 14px; }

.player-info {
font-size: 14px;
}

.score {
font-size: 16px;
font-weight: 600;
color: #64B5F6;
text-align: right;
}

.loading {
display: none;
text-align: center;
padding: 20px;
color: #9e9e9e;
}

.error {
background: #B71C1C;
color: white;
padding: 12px;
border-radius: 6px;
margin-bottom: 16px;
display: none;
}

.success {
background: #2E7D32;
color: white;
padding: 12px;
border-radius: 6px;
margin-bottom: 16px;
display: none;
}

@media (max-width: 480px) {
h1 {
font-size: 26px;
}

.stats-grid {
grid-template-columns: repeat(3, 1fr);
gap: 8px;
}

.stat-card {
padding: 12px;
}

.stat-value {
font-size: 24px;
}
}
</style>
</head>
<body>
<div class="container">
<h1>Friday Football Manager</h1>

<div class="error" id="errorMsg"></div>
<div class="success" id="successMsg"></div>
<div class="loading" id="loading">Loading...</div>

<!-- Stats Overview -->
<div class="stats-grid">
<div class="stat-card">
<div class="stat-value" id="registeredCount">0</div>
<div class="stat-label">Registered</div>
</div>
<div class="stat-card">
<div class="stat-value" id="spotsLeft">15</div>
<div class="stat-label">Spots Left</div>
</div>
<div class="stat-card">
<div class="stat-value" id="nextGame">Nov 1</div>
<div class="stat-label">Next Game</div>
</div>
</div>

<!-- Registration Section -->
<div class="section">
<div class="section-title">Register for Next Game</div>
<select id="playerSelect">
<option value="">Select your name</option>
</select>
<button class="btn-primary" onclick="registerPlayer()">Register</button>
<button class="btn-danger" onclick="unregisterPlayer()">Unregister</button>
</div>

<!-- Registered Players -->
<div class="section">
<div class="section-title">Registered Players</div>
<div class="player-list" id="registeredList">
<div class="empty-state">No players registered yet</div>
</div>
</div>

<!-- Admin Controls -->
<div class="section admin-section">
<div class="section-title">Admin Controls</div>
<input type="password" id="adminPassword" placeholder="Admin Password">
<button class="btn-warning" onclick="toggleTeamBuilder()">Organize Teams</button>
<button class="btn-success" onclick="showAddPlayer()">Add New Player</button>

<div class="team-builder" id="teamBuilder">
<div class="section-title" style="margin-top: 24px;">Team Organization</div>
<div class="team-grid" id="teamsGrid"></div>
<button class="btn-success" onclick="saveTeams()">Save Teams</button>
</div>

<div class="team-builder" id="addPlayerSection">
<input type="text" id="newPlayerName" placeholder="New Player Name">
<button class="btn-success" onclick="addNewPlayer()">Add Player</button>
</div>

<div class="team-builder" id="statsEntrySection">
<div class="section-title" style="margin-top: 24px;">Record Match Stats</div>
<select id="matchPlayer">
<option value="">Select Player</option>
</select>
<input type="number" id="goals" placeholder="Goals" min="0">
<input type="number" id="assists" placeholder="Assists" min="0">
<button class="btn-success" onclick="recordStats()">Record Stats</button>
</div>
</div>

<!-- Statistics Section -->
<div class="section stats-section">
<div class="section-title">Top Scorers - This Month</div>
<div class="leaderboard" id="monthlyScorers">
<div class="empty-state">No stats yet</div>
</div>
</div>

<div class="section">
<div class="section-title">Top Scorers - This Year</div>
<div class="leaderboard" id="yearlyScorers">
<div class="empty-state">No stats yet</div>
</div>
</div>

<div class="section">
<div class="section-title">Top Assists - This Month</div>
<div class="leaderboard" id="monthlyAssists">
<div class="empty-state">No stats yet</div>
</div>
</div>

<div class="section">
<div class="section-title">Top Assists - This Year</div>
<div class="leaderboard" id="yearlyAssists">
<div class="empty-state">No stats yet</div>
</div>
</div>
</div>

<script>
// CONFIGURACIÃ“N - Reemplazar con tu Google Apps Script Web App URL
const API_URL = 'https://script.google.com/macros/s/AKfycbwZhfcGxw6imtHxQ-rcYSYboCHIsCVa3bZmo9YYEYIbhSdorV-nQO2XbeaiYOlZO5Aw/exec';
const ADMIN_PASSWORD = 'Solari'; // Cambiar esto por tu password

let currentPlayers = [];
let registeredPlayers = [];

// Initialize app
async function init() {
showLoading(true);
try {
await loadPlayers();
await loadRegistrations();
await loadStats();
updateNextGameDate();
} catch (error) {
showError('Failed to initialize app: ' + error.message);
}
showLoading(false);
}

// Load all players
async function loadPlayers() {
try {
const response = await fetch(`${API_URL}?action=getPlayers`);
const data = await response.json();
currentPlayers = data.players || [];

const select = document.getElementById('playerSelect');
const matchSelect = document.getElementById('matchPlayer');
select.innerHTML = '<option value="">Select your name</option>';
matchSelect.innerHTML = '<option value="">Select Player</option>';

currentPlayers.forEach(player => {
const option = document.createElement('option');
option.value = player;
option.textContent = player;
select.appendChild(option);

const matchOption = option.cloneNode(true);
matchSelect.appendChild(matchOption);
});
} catch (error) {
console.error('Error loading players:', error);
}
}

// Load registrations
async function loadRegistrations() {
try {
const response = await fetch(`${API_URL}?action=getRegistrations`);
const data = await response.json();
registeredPlayers = data.registrations || [];

document.getElementById('registeredCount').textContent = registeredPlayers.length;
document.getElementById('spotsLeft').textContent = Math.max(0, 15 - registeredPlayers.length);

const list = document.getElementById('registeredList');
if (registeredPlayers.length === 0) {
list.innerHTML = '<div class="empty-state">No players registered yet</div>';
} else {
list.innerHTML = '';
registeredPlayers.forEach(player => {
const item = document.createElement('div');
item.className = 'player-item';
item.innerHTML = `
<span class="player-name">${player.name}</span>
<span class="player-games">${player.gamesPlayed || 0} games</span>
`;
list.appendChild(item);
});
}
} catch (error) {
console.error('Error loading registrations:', error);
}
}

// Register player
async function registerPlayer() {
const playerName = document.getElementById('playerSelect').value;
if (!playerName) {
showError('Please select your name');
return;
}

showLoading(true);
try {
const response = await fetch(API_URL, {
method: 'POST',
headers: { 'Content-Type': 'application/json' },
body: JSON.stringify({
action: 'register',
playerName: playerName
})
});

const data = await response.json();
if (data.success) {
showSuccess('Successfully registered!');
await loadRegistrations();
} else {
showError(data.message || 'Registration failed');
}
} catch (error) {
showError('Error: ' + error.message);
}
showLoading(false);
}

// Unregister player
async function unregisterPlayer() {
const playerName = document.getElementById('playerSelect').value;
if (!playerName) {
showError('Please select your name');
return;
}

showLoading(true);
try {
const response = await fetch(API_URL, {
method: 'POST',
headers: { 'Content-Type': 'application/json' },
body: JSON.stringify({
action: 'unregister',
playerName: playerName
})
});

const data = await response.json();
if (data.success) {
showSuccess('Successfully unregistered');
await loadRegistrations();
} else {
showError(data.message || 'Unregistration failed');
}
} catch (error) {
showError('Error: ' + error.message);
}
showLoading(false);
}

// Verify admin password
function verifyAdmin() {
const password = document.getElementById('adminPassword').value;
if (password !== ADMIN_PASSWORD) {
showError('Invalid admin password');
return false;
}
return true;
}

// Toggle team builder
function toggleTeamBuilder() {
if (!verifyAdmin()) return;

const builder = document.getElementById('teamBuilder');
const statsEntry = document.getElementById('statsEntrySection');
builder.style.display = builder.style.display === 'none' ? 'block' : 'none';
statsEntry.style.display = 'block';

if (builder.style.display === 'block') {
buildTeams();
}
}

// Build teams automatically
function buildTeams() {
const grid = document.getElementById('teamsGrid');
const numTeams = Math.min(3, Math.ceil(registeredPlayers.length / 5));

grid.innerHTML = '';

const shuffled = [...registeredPlayers].sort(() => Math.random() - 0.5);

for (let i = 0; i < numTeams; i++) {
const teamBox = document.createElement('div');
teamBox.className = 'team-box';
teamBox.innerHTML = `<div class="team-name">Team ${i + 1}</div>`;

const teamPlayers = shuffled.slice(i * 5, (i + 1) * 5);
teamPlayers.forEach(player => {
const playerDiv = document.createElement('div');
playerDiv.className = 'team-player';
playerDiv.textContent = player.name;
teamBox.appendChild(playerDiv);
});

grid.appendChild(teamBox);
}
}

// Save teams
async function saveTeams() {
if (!verifyAdmin()) return;

showSuccess('Teams saved successfully!');
// AquÃ­ puedes agregar lÃ³gica para guardar en Google Sheets
}

// Show add player section
function showAddPlayer() {
if (!verifyAdmin()) return;

const section = document.getElementById('addPlayerSection');
section.style.display = section.style.display === 'none' ? 'block' : 'none';
}

// Add new player
async function addNewPlayer() {
const playerName = document.getElementById('newPlayerName').value.trim();
if (!playerName) {
showError('Please enter a player name');
return;
}

showLoading(true);
try {
const response = await fetch(API_URL, {
method: 'POST',
headers: { 'Content-Type': 'application/json' },
body: JSON.stringify({
action: 'addPlayer',
playerName: playerName
})
});

const data = await response.json();
if (data.success) {
showSuccess('Player added successfully!');
document.getElementById('newPlayerName').value = '';
await loadPlayers();
} else {
showError(data.message || 'Failed to add player');
}
} catch (error) {
showError('Error: ' + error.message);
}
showLoading(false);
}

// Record stats
async function recordStats() {
if (!verifyAdmin()) return;

const player = document.getElementById('matchPlayer').value;
const goals = parseInt(document.getElementById('goals').value) || 0;
const assists = parseInt(document.getElementById('assists').value) || 0;

if (!player) {
showError('Please select a player');
return;
}

showLoading(true);
try {
const response = await fetch(API_URL, {
method: 'POST',
headers: { 'Content-Type': 'application/json' },
body: JSON.stringify({
action: 'recordStats',
player: player,
goals: goals,
assists: assists
})
});

const data = await response.json();
if (data.success) {
showSuccess('Stats recorded successfully!');
document.getElementById('goals').value = '';
document.getElementById('assists').value = '';
await loadStats();
} else {
showError(data.message || 'Failed to record stats');
}
} catch (error) {
showError('Error: ' + error.message);
}
showLoading(false);
}

// Load statistics
async function loadStats() {
try {
const response = await fetch(`${API_URL}?action=getStats`);
const data = await response.json();

renderLeaderboard('monthlyScorers', data.monthlyScorers || []);
renderLeaderboard('yearlyScorers', data.yearlyScorers || []);
renderLeaderboard('monthlyAssists', data.monthlyAssists || []);
renderLeaderboard('yearlyAssists', data.yearlyAssists || []);
} catch (error) {
console.error('Error loading stats:', error);
}
}

// Render leaderboard
function renderLeaderboard(elementId, data) {
const container = document.getElementById(elementId);

if (data.length === 0) {
container.innerHTML = '<div class="empty-state">No stats yet</div>';
return;
}

container.innerHTML = '';
data.forEach((item, index) => {
const div = document.createElement('div');
div.className = 'leaderboard-item';

let rankClass = 'rank-other';
let rankText = `#${index + 1}`;
if (index === 0) { rankClass = 'rank'; rankText = 'ðŸ¥‡'; }
else if (index === 1) { rankClass = 'rank rank-2'; rankText = 'ðŸ¥ˆ'; }
else if (index === 2) { rankClass = 'rank rank-3'; rankText = 'ðŸ¥‰'; }

div.innerHTML = `
<div class="${rankClass}">${rankText}</div>
<div class="player-info">${item.player}</div>
<div class="score">${item.value}</div>
`;
container.appendChild(div);
});
}

// Update next game date
function updateNextGameDate() {
const today = new Date();
const dayOfWeek = today.getDay();
const daysUntilFriday = (5 - dayOfWeek + 7) % 7 || 7;
const nextFriday = new Date(today);
nextFriday.setDate(today.getDate() + daysUntilFriday);

const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
const dateStr = `${months[nextFriday.getMonth()]} ${nextFriday.getDate()}`;

document.getElementById('nextGame').textContent = dateStr;
}

// Helper functions
function showLoading(show) {
document.getElementById('loading').style.display = show ? 'block' : 'none';
}

function showError(message) {
const errorDiv = document.getElementById('errorMsg');
errorDiv.textContent = message;
errorDiv.style.display = 'block';
setTimeout(() => errorDiv.style.display = 'none', 5000);
}

function showSuccess(message) {
const successDiv = document.getElementById('successMsg');
successDiv.textContent = message;
successDiv.style.display = 'block';
setTimeout(() => successDiv.style.display = 'none', 3000);
}

// Initialize on load
window.addEventListener('load', init);
</script>
</body>

</html>
